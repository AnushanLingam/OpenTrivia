# JSGameManager
A set of functions designed to make creating and managing a lobby system for web apps or games easily using Socket.IO. 

Click [here](https://www.npmjs.com/package/js-gamemanager) to view on npm

Click [here](https://runkit.com/embed/a3aa4buu470o) to play around with this module in your browser with RunKit

#### Requirements
* NPM and Node.JS
* Install the Socket.IO module using `install socket.io --save`

### Documentation

#### Game Object
The Game object consists of the following properties by default:

`host` which contains the socket ID assigned by socketIO for the host of that lobby.

`players` which is an empty array that you can add players joining this lobby to.

`name` which stores the string identifier for this game lobby.

`toString` which overrides the default toString function to make printing object to console cleaner.

Example: 
```javascript
let game = {
      host: X32BZ342313,
	  name: "Lobby1",
      players: [],
	  toString: function(){...}
   }
```

#### Player Object
The player object consists of the following properties by default:

`username` is pretty self explanatory it stores the username of the connecting player.

`id` stores the socketIO assigned id associated with the player. This is what you use to access this specific player as the id is sent by socketIO on every message and its unique to each client.

`score` is again pretty simple. Its just provides a way to store the players score. Default value = 0.

`toString` which overrides the default toString function to make printing object to console cleaner.

Example
```javascript
let player = {
  username: james,
  id: X32BZ342313,
  score: 0,
  toString: function(){...}
}
```

#### Usage

Firstly initialise the manager module and create a global object to store all active games:

```javascript
const manager = require("js-gamemanager");
let games = {};
```

The `doesExist` function is used determine whether a specfic value exists within an object. Can be used to check whether an username or lobby name already exists.

For example when you recieve an socket.IO event to create a new lobby:
```javascript
 socket.on("newGame", function(data)) {
    // data will contain information you send when a client requests to host a game. This can include data such as a lobby name.
    if(!manager.doesExist(data[1], games) {
      // If no such lobby exists with the given name you can execute code to create this lobby.
    } else {
      // emit a message to client asking them to change name as it is already used.
    }
 }
```

The `checkUsername` function can be used to verify if an username is available before assigining it to a player. You pass it three values which are 
the name you want to check, the lobby you want to check against and the active games object.

For example to check if 'James' is available:
```javascript
console.log(manager.checkUsername("James", "lobby1", games));
// Will output true or false depending on whether the name is taken or not.
```

The `createGame` function simply creates and returns a game object when called. You need to pass it the socket ID of the client that requested this so that the host property can be set accordingly.
For example:
```javascript
socket.on("newGame", function(ID)) {
  let newGame = manager.createGame(ID)
}
```
The `createPlayer` function will create a player and return a player object. You need to pass it the username entered by the client as well as the ID generated by socketIO.
For example:
```javascript
socket.on("playerJoined", function(data){
  // in this example data[0] is the username and data[1] is the ID of the user and data[2] is the lobby they want to join.
  let player = manager.createPlayer(data[0], data[1]);
  // Now add the player to the correct game after using doesExist to verify it exists
  games[data[2]].players.push(player);
}
```
The getClientType function provides a way to check whether an ID belongs to a Host or a player as well as the particuluar lobby it belongs to. You pass it the socket ID of the requesting client as well as the global games object that stores all running games. It then treturn an array containing the string `"host" or "player"` and the name of the lobby they belong to.
For example:
```javascript
let response = manager.getClientType(ID, games);
// Lets assume this ID belongs to a host in a room called potato
console.log("type " + response[0] + " lobby name: " + response[1]);
// The output will be: type: host lobby name: potato 
```

The `removePlayer` function is used to update the game object and remove the disconnecting player from the list of players. It requires the ID of the disconnecting player as well as the player list of the game they belong to. The latter can be obtained using the previously detailed getClientType function.
For example:
```javascript
let response = manager.getClientType(ID, games); 
let remainingPlayers = manager.removePlayer(ID, games[response[1].playerList);
games[response[1]].playerList = remainingPlayers;
```

The `stringifyData` function is used to convert the whole games object or playerlist into an easily readable string. Consists of three modes: "GAMES", "PLAYERS", "ALL".
Visit the RunKit link at the top of the page to see the output of each one as well as demos of all the other functions.

For example to print a list of active games:
```javascript
console.log(manager.stringifyData(games["lobby1"].players, "PLAYERS"));
/*
Example output:
Player Info:
Username: Tom | Socket ID: s23sddz2
Username: James | Socket ID: F563829S
*/
```
